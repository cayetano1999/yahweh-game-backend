parameters:
  - name: name
    type: string
    default: ""
  - name: projectName
    type: string
    default: ""
  - name: timeout
    type: string
    default: "300"
  - name: resultsDirectory
    type: string
    default: ""

steps:
  # - task: DownloadPipelineArtifact@2
  #   displayName: "Download Build Artifacts"
  #   inputs:
  #     artifact: "${{ parameters.projectName }}-tests"
  #     path: "${{ parameters.resultsDirectory }}"

  - task: SonarQubePrepare@5
    displayName: "Sonar Qube Prepare"
    inputs:
      SonarQube: ${{ parameters.name }}
      scannerMode: "CLI"
      configMode: "file"

  - task: SonarQubeAnalyze@5
    displayName: "Sonar Qube Analyze"

  - task: SonarQubePublish@5
    displayName: "Sonar Qube Publish"
    inputs:
      pollingTimeoutSec: ${{ parameters.timeout }}
